# IoM UI Project Rules

## STRICT FILE NAMING CONVENTIONS - ALWAYS ENFORCE

### React Components
- **MUST** use PascalCase: `ObjectDetailsSheet.tsx`, `ModelSelector.tsx`
- **NEVER** use kebab-case or snake_case for components

### Hooks
- **MUST** use camelCase: `useObjectOperations.ts`, `useModelData.ts`
- **ALWAYS** start with "use" prefix
- **NEVER** use kebab-case: `use-object-operations.ts` ❌

### Utilities & Helpers
- **MUST** use kebab-case: `object-operations-utils.ts`, `column-helpers.ts`
- **NEVER** use camelCase: `objectOperationsUtils.ts` ❌
- **NEVER** use snake_case: `object_operations_utils.ts` ❌

### Pages & Routes (Next.js)
- **MUST** use kebab-case: `import-status/page.tsx`, `object-model/page.tsx`
- **NEVER** use camelCase: `importStatus/page.tsx` ❌

### Types & Interfaces
- **MUST** use kebab-case: `object-types.ts`, `api-types.ts`
- **NEVER** use camelCase: `objectTypes.ts` ❌

## ARCHITECTURE PATTERNS - STRICTLY ENFORCE

### API Integration
- **ALWAYS** use centralized API hooks in `src/hooks/api/`
- **NEVER** call `iob-client` directly in components
- **ALWAYS** use React Query mutations for API calls
- **MUST** include proper error handling with toast notifications

### Component Organization
- **COMPLEX COMPONENTS MUST** follow organized structure:
  ```
  component-name/
  ├── components/     # Sub-components (PascalCase files)
  ├── hooks/          # Feature hooks (camelCase files)  
  ├── utils/          # Utilities (kebab-case files)
  └── index.ts        # Clean exports
  ```

### State Management Rules
- **ALWAYS** use `useState` for local component state
- **ALWAYS** use React Query for server state
- **NEVER** mix server state with local state
- **MUST** use proper loading and error states

### Self-Contained Components
- **SHEETS MUST** handle their own CRUD operations internally
- **NEVER** pass save handlers from parent pages to sheets
- **SHEETS MUST** use `useObjectOperations` or similar hooks internally
- **PARENT PAGES** should only handle UI state (open/close, selected items)

## CODE QUALITY RULES - STRICTLY ENFORCE

### Import Organization
- **MUST** group imports: React → Third-party → Internal → Types
- **MUST** use clean exports from index files
- **NEVER** import directly when index exists: `./component/Component` ❌, use `./component` ✅

### Function Organization
- **UTILITY FUNCTIONS** over 20 lines MUST be extracted to utils folder
- **HOOKS** should focus on state management, not utility logic
- **COMPONENTS** should focus on UI, not business logic

### Error Handling
- **ALWAYS** use toast notifications for user feedback
- **ALWAYS** include loading states for async operations
- **MUST** handle both success and error cases
- **NEVER** leave try-catch blocks without user feedback

### TypeScript Usage
- **ALWAYS** use proper TypeScript types
- **AVOID** `any` type unless absolutely necessary
- **MUST** define interfaces for all data structures
- **PREFER** type inference where appropriate

## TEMPLATE/MODEL SYSTEM RULES

### Template Creation
- **MUST** include `isTemplate: true` for all template operations
- **MUST** strip address, files, and parents when creating templates
- **MUST** use `useObjectOperations` with `isTemplate: true`

### Revert Operations
- **MUST** preserve `isTemplate` status during revert
- **MUST** use appropriate toast messages for templates vs objects
- **MUST** include proper loading states

## PERFORMANCE RULES

### API Calls
- **ALWAYS** use React Query caching
- **MUST** include proper `staleTime` and `cacheTime`
- **ALWAYS** invalidate related queries after mutations
- **USE** optimistic updates where appropriate

### Component Rendering
- **USE** `React.memo` for expensive components
- **PROPER** dependency arrays for `useEffect`
- **AVOID** unnecessary re-renders

## FORBIDDEN PATTERNS - NEVER DO THESE

### File Naming Violations
- ❌ `objectOperationsUtils.ts` (camelCase utility)
- ❌ `use-object-operations.ts` (kebab-case hook)
- ❌ `ObjectDetailsSheet.js` (wrong extension)
- ❌ `object_details_sheet.tsx` (snake_case component)

### Architecture Violations
- ❌ Direct `iob-client` usage in components
- ❌ Save handlers in parent pages for self-contained sheets
- ❌ Mixing server state with local state
- ❌ Missing error handling in async operations

### Code Organization Violations
- ❌ Utility functions embedded in hooks (>20 lines)
- ❌ Business logic in UI components
- ❌ Direct file imports when index exists
- ❌ Missing TypeScript types

## ENFORCEMENT CHECKLIST

Before any code change, verify:
- [ ] File names follow correct convention for file type
- [ ] Components are self-contained with internal CRUD operations
- [ ] API calls use centralized hooks with proper error handling
- [ ] Utility functions are extracted to utils folder
- [ ] Imports are organized and use index files
- [ ] TypeScript types are properly defined
- [ ] Loading and error states are implemented
- [ ] Template operations preserve `isTemplate` status

## MIGRATION STRATEGY

When refactoring existing code:
1. **FIRST** - Fix file naming to match conventions
2. **SECOND** - Update all import statements
3. **THIRD** - Extract utility functions to utils folder
4. **FOURTH** - Ensure components are self-contained
5. **FIFTH** - Add proper error handling and loading states
6. **LAST** - Test all functionality works correctly

Remember: These rules exist to maintain code quality, consistency, and developer productivity. Always follow them strictly.
